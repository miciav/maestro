dag:
  name: "wait_and_retry"
  tasks:
    - task_id: "unstable_task"
      type: "PythonTask"
      params:
        code: |
          import random, sys, time
          generate_random = random.random()
          print(f"Generated: {round(generate_random, 2)}")
          if generate_random < 0.67:
              print("Failure occurred")
              sys.exit(1)
          else:
            print("Success on this run!")
      retries: 3
      retry_delay: 1
      dependencies: []
    - task_id: "final_message"
      type: "PrintTask"
      params:
        message: "Pipeline finished after retry logic"
      dependencies: ["unstable_task"]
