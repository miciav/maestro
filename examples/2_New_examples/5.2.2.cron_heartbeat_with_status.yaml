abstract: |
  This DAG enhances the heartbeat concept by logging system status at every cron tick. It performs quick Bash-based system snapshots (disk, memory, processes) alongside the heartbeat message. This setup tests recurring system diagnostics, multi-step scheduled pipelines, and orchestrator stability under repeated periodic commands.

dag:
  name: "cron_heartbeat_with_status"
  cron_schedule: "*/10 * * * *"  # Each 10 minutes

  tasks:
    # 1) Evaluate a fake state of the system
    - task_id: "compute_status"
      type: "PythonTask"
      params:
        code: |
          import random
          status = random.choice(["OK", "DEGRADED", "ERROR"])
          print(f"Computed heartbeat status: {status}")
      dependencies: []

    # 2) Print a readable message to the console
    - task_id: "print_status"
      type: "PrintTask"
      params:
        message: "Heartbeat status computed and printed above."
      dependencies: ["compute_status"]

    # 3) Write a minimal log on the console (in /tmp)
    - task_id: "log_to_file"
      type: "BashTask"
      params:
        command: |
          mkdir -p runtime/tmp
          echo "$(date) - Heartbeat executed" >> runtime/tmp/maestro_heartbeat.log
      dependencies: ["print_status"]

