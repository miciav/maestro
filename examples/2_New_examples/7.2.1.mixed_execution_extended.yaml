abstract: |
  This DAG extends the original mixed_execution example by introducing
  a multi-step data-processing workflow that mixes PrintTask, PythonTask,
  and BashTask execution in a longer and more realistic sequence.

  The pipeline performs:
    - Initialization/logging
    - Python generation of data.json
    - Bash extraction and transformation of data
    - Python validation of manipulated results
    - Final PrintTask summarizing the process

  This DAG is ideal for testing:
    - Sequential mixed-executor behavior
    - File creation + reading across Python/Bash boundaries
    - Logging clarity during multi-step data transformations

dag:
  name: "mixed_execution_extended"

  tasks:

    # ---------------------------------------------------------
    # 1) Initialization
    # ---------------------------------------------------------
    - task_id: "init"
      type: "PrintTask"
      params:
        message: "Starting extended mixed execution pipeline..."
      dependencies: []

    # ---------------------------------------------------------
    # 2) Generate a JSON file using Python
    # ---------------------------------------------------------
    - task_id: "generate_data"
      type: "PythonTask"
      params:
        script: |
          import json
          data = {"values": [1, 2, 3, 4, 5, 6]}
          with open("data.json", "w") as f:
            json.dump(data, f)
          print("Generated data.json with 6 values.")
      dependencies: ["init"]

    # ---------------------------------------------------------
    # 3) Extract values using a Bash pipeline
    # ---------------------------------------------------------
    - task_id: "extract_numbers"
      type: "BashTask"
      params:
        command: "cat data.json | grep -o '[0-9]' > extracted.txt"
      dependencies: ["generate_data"]

    # ---------------------------------------------------------
    # 4) Count extracted values (Bash)
    # ---------------------------------------------------------
    - task_id: "count_numbers"
      type: "BashTask"
      params:
        command: "wc -l extracted.txt"
      dependencies: ["extract_numbers"]

    # ---------------------------------------------------------
    # 5) Validate inside Python
    # ---------------------------------------------------------
    - task_id: "python_validation"
      type: "PythonTask"
      params:
        script: |
          with open("extracted.txt") as f:
            lines = f.readlines()
          print("Python validation: extracted", len(lines), "numbers.")
      dependencies: ["count_numbers"]

    # ---------------------------------------------------------
    # 6) Final message
    # ---------------------------------------------------------
    - task_id: "finish"
      type: "PrintTask"
      params:
        message: "Extended mixed execution pipeline completed successfully!"
      dependencies: ["python_validation"]
