dag:
  tasks:
    - task_id: check_condition
      type: "PythonTask"
      code: |
        import random
        result = "branch_a" if random.random() > 0.5 else "branch_b"
        print(f"Next step: {result}")
        task_output = {"branch": result}

    - task_id: branch_a
      type: "PrintTask"
      message: "Eseguo branch A"
      dependencies: [check_condition]
      condition: "output_of('check_condition')['branch'] == 'branch_a'"

    - task_id: branch_b
      type: "PrintTask"
      message: "Eseguo branch B"
      dependencies: [check_condition]
      condition: "output_of('check_condition')['branch'] == 'branch_b'"
